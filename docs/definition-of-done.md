# Definition of Done (DoD) - process-network-monitor

## 1. この文書の目的

この文書は「どこまで実装したら、いったんプロダクトを完了とみなすか」を定義する。
Issueが増え続けても、リリース判断をぶらさないための基準として使う。

---

## 2. 開発経緯（要約）

### 初期フェーズ（基本機能の成立）
- #1 基本的な通信取得とグラフ表示（完了）
- #3 単位の自動調整機能（完了）
- #6 No traffic detected 表示位置修正（完了）
- #7 通信量が0になりやすい計測ロジック改善 + 再現モード（完了）

### 信頼性・保守性フェーズ（2026-02-27）
- #10 エラーハンドリング強化（完了、PR #16 マージ済み）
- #11 スキャナ参照寿命短縮・メモリ傾向改善（完了、PR #17 マージ済み）
- Reliability & Maintainability マイルストーンを設定

### 現在の未完了課題
- #12 初期待機の固定2秒を廃止し準備完了シグナルで開始（OPEN）
- #13 グローバル状態を削減しテスト容易性を改善（OPEN）
- #14 計測タイミングを単調増加クロックへ統一し精度向上（OPEN）
- #15 printベース出力をloggingへ移行（OPEN）

---

## 3. 現在地（2026-02-28時点）

- 高優先（priority:high）は #10, #11 を解消済み
- 実行上の致命リスクは低減済み
- ただし、計測精度・設計整理・運用ログは改善余地あり

結論：
「壊れにくくなったが、完了宣言できる基準がまだ曖昧」な段階。

---

## 4. v1.0 の対象範囲（今回の“終わり”）

v1.0では、以下を**必須（Must）**とする。

1. 測定と出力の成立
- デフォルト実行で計測完了し、`network_traffic.png` を保存できる
- `FORCE_NO_TRAFFIC=1` 実行でも異常終了しない

2. 信頼性
- 想定外エラー時にハングせず終了する
- バックグラウンドスレッド停止の後始末が保証される

3. 直近の中優先課題のうち、v1.0品質に直結する項目
- #12 固定2秒待機の除去（準備完了イベント化）
- #14 単調増加クロック化（`time.perf_counter()` ベース）

4. ドキュメント
- READMEに実行方法、再現モード、メモリ確認手順がある
- 本DoD文書が最新状態になっている

---

## 5. v1.0 Definition of Done（完了判定）

以下を満たしたら v1.0 完了と判定する。

### A. 実装
- [ ] #12 がクローズされている
- [ ] #14 がクローズされている
- [ ] #10, #11 の回帰が発生していない

### B. 動作確認（最小セット）
- [ ] `python3 monitor_network.py` が成功終了（exit code 0）
- [ ] `FORCE_NO_TRAFFIC=1 python3 monitor_network.py` が成功終了（exit code 0）
- [ ] 連続5回実行で極端なメモリ増加が再現しない

### C. 開発プロセス
- [ ] すべてPR経由で main に反映
- [ ] 各Issueに「対応内容」「確認結果」がコメントで残っている

### D. リリース判断
- [ ] Must課題が0件
- [ ] 未対応課題は v1.1 バックログへ移管済み

---

## 6. v1.1 へ回す項目（現時点案）

- #13 グローバル状態のさらなる整理（テスト容易性の改善）
- #15 logging移行（運用性向上）

理由：
v1.0の必須品質に対しては優先度が一段下がるため。

---

## 7. 追加Issue候補（必要なら作成）

DoD運用を安定化するため、次のIssue追加を推奨。

1. [Process] v1.0 リリースチェックリストを作成
- 目的: DoDのA〜Dを1つの追跡Issueで見える化する

2. [Docs] Definition of Done の運用ルールをREADMEにリンク
- 目的: 新規参加者が完了基準を迷わないようにする

3. [Test] 最小回帰チェックの自動化（通常実行/再現モード）
- 目的: #10/#11 の品質を継続的に守る

---

## 8. 運用ルール（短縮版）

- 新しいIssueは Must / Should / Could のいずれかに分類する
- v1.0では Must のみを完了対象とする
- Mustが0になった時点で「v1.0 完了」を宣言する
- その後の改善は v1.1 として別管理する
